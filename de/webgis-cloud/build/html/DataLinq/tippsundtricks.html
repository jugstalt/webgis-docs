

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="de" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="de" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>5 Tipps und tricks für Views &mdash; WebGIS Cloud Dokumentation 2020 Dokumentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script src="../_static/js/eni.js"></script>
        <script src="../_static/translations.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/eni.css" type="text/css" />
    <link rel="index" title="Stichwortverzeichnis" href="../genindex.html" />
    <link rel="search" title="Suche" href="../search.html" />
    <link rel="next" title="6 Weitere Beispiele" href="examples.html" />
    <link rel="prev" title="4 Aufruf und Beispiele" href="aufrufundbeispiele.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> WebGIS Cloud Dokumentation
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Inhalt:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">DataLinq</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="allgemeines.html"><span class="sectnum">1</span> Allgemeines</a></li>
<li class="toctree-l2"><a class="reference internal" href="technischeumsetzung.html"><span class="sectnum">2</span> Technische Umsetzung</a></li>
<li class="toctree-l2"><a class="reference internal" href="parametrierung.html"><span class="sectnum">3</span> Parametrierung</a></li>
<li class="toctree-l2"><a class="reference internal" href="aufrufundbeispiele.html"><span class="sectnum">4</span> Aufruf und Beispiele</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#"><span class="sectnum">5</span> Tipps und tricks für Views</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#zugriff-auf-abfrageergebnisse"><span class="sectnum">5.1</span> Zugriff auf Abfrageergebnisse</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hilfsfunktionen"><span class="sectnum">5.2</span> Hilfsfunktionen</a></li>
<li class="toctree-l3"><a class="reference internal" href="#beschrankung-der-abfrageergebnisse-query"><span class="sectnum">5.3</span> Beschränkung der Abfrageergebnisse - Query</a></li>
<li class="toctree-l3"><a class="reference internal" href="#beschrankung-filtern-der-abfrageergebnisse"><span class="sectnum">5.4</span> Beschränkung / Filtern der Abfrageergebnisse</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sortieren-der-abfrageergebnisse"><span class="sectnum">5.5</span> Sortieren der Abfrageergebnisse</a></li>
<li class="toctree-l3"><a class="reference internal" href="#aktualisierung-aufteilen-von-statischen-und-dynamischen-inhalten"><span class="sectnum">5.6</span> Aktualisierung - Aufteilen von statischen und dynamischen Inhalten</a></li>
<li class="toctree-l3"><a class="reference internal" href="#queries-mit-domain-ubersetzung"><span class="sectnum">5.7</span> Queries mit Domain-Übersetzung</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="examples.html"><span class="sectnum">6</span> Weitere Beispiele</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../MapBuilder/index.html">Map Builder</a></li>
<li class="toctree-l1"><a class="reference internal" href="../KartenViewer/index.html">Karten Viewer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Tutorials/index.html">Tutorials</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">WebGIS Cloud Dokumentation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">DataLinq</a> &raquo;</li>
        
      <li><span class="sectnum">5</span> Tipps und tricks für Views</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/DataLinq/tippsundtricks.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="tipps-und-tricks-fur-views">
<h1><span class="sectnum">5</span> Tipps und tricks für Views<a class="headerlink" href="#tipps-und-tricks-fur-views" title="Link zu dieser Überschrift">¶</a></h1>
<div class="section" id="zugriff-auf-abfrageergebnisse">
<span id="anchor51"></span><h2><span class="sectnum">5.1</span> Zugriff auf Abfrageergebnisse<a class="headerlink" href="#zugriff-auf-abfrageergebnisse" title="Link zu dieser Überschrift">¶</a></h2>
<p>Die Ergebnisse der Abfrage werden dem View als Model übergeben:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Model.Success</span></code></p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p><em>bool</em></p></li>
<li><p>war die Abfrage erfolgreich</p></li>
</ul>
</div></blockquote>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Model.CountRecords</span></code></p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p><em>integer</em></p></li>
<li><p>Anzahl der zurückgegebenen Datensätze</p></li>
</ul>
</div></blockquote>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Model.ElapsedMillisconds</span></code></p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p><em>integer</em></p></li>
<li><p>Abfragedauer in Millisekunden</p></li>
</ul>
</div></blockquote>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Model.Records</span></code></p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p><em>Dictionary&lt;string,object&gt;[]</em></p></li>
<li><p>Enthält die Datensätze des Ergebnisses</p></li>
<li><p><strong>ACHTUNG:</strong> da der Wert als Object-Typ gespeichert ist, sind <strong>keine</strong> direkten Vergleichsoperationen wie <code class="docutils literal notranslate"><span class="pre">record[‘NAME‘]</span> <span class="pre">==</span> <span class="pre">‘Franz‘</span></code> möglich (Referenzvergleich). Hier muss über Equals verglichen werden, bspw. <code class="docutils literal notranslate"><span class="pre">&quot;Franz&quot;.Equals(record[&quot;NAME&quot;])</span></code></p></li>
</ul>
</div></blockquote>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Model.QueryString</span></code></p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p><em>NameValueCollection</em></p></li>
<li><p>Enthält die Übergabeparameter des Aufrufes</p></li>
<li><p>Zugriff bspw. über: <code class="docutils literal notranslate"><span class="pre">Model.QueryString[&quot;Parametername&quot;]</span></code></p></li>
</ul>
</div></blockquote>
<p>Auf die Datensätze im Dictionary kann über Linq zugegriffen werden:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Model</span><span class="o">.</span><span class="n">Records</span><span class="o">.</span><span class="n">Where</span><span class="p">(</span><span class="n">r</span><span class="o">=&gt;</span><span class="n">String</span><span class="o">.</span><span class="n">IsNullOrEmpty</span><span class="p">(</span><span class="n">Model</span><span class="o">.</span><span class="n">QueryString</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">])</span> <span class="o">||</span> <span class="n">Model</span><span class="o">.</span><span class="n">QueryString</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">Equals</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="s2">&quot;x_field&quot;</span><span class="p">]))</span><span class="o">.</span><span class="n">OrderBy</span><span class="p">(</span><span class="n">r</span><span class="o">=&gt;</span><span class="n">r</span><span class="p">[</span><span class="s2">&quot;data_field&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="hilfsfunktionen">
<span id="anchor52"></span><h2><span class="sectnum">5.2</span> Hilfsfunktionen<a class="headerlink" href="#hilfsfunktionen" title="Link zu dieser Überschrift">¶</a></h2>
<p>Es gibt einige Hilfsfunktionen („DataLinqHelper“) mit denen zusätzliche Daten eingebunden oder etwa Formulare erzeugt werden können. Als Abkürzung kann statt „DataLinqHelper“ auch „DLH“ verwendet werden:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">DataLinqHelper.IncludeView(url)</span></code></p></li>
</ul>
<blockquote>
<div><ul>
<li><p>Zeigt in einem View Daten aus einem anderen an</p></li>
<li><p>Die URL ist ab der Endpunkt-Bezeichnung einzugeben:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>DataLinqHelper.IncludeView(“ssg-sdet@proj-geb@proj-geb-bestand?GebaeudeId =E313049“)
</pre></div>
</div>
</li>
</ul>
</div></blockquote>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">DataLinqHelper.IncludeClickView(url,text)</span></code></p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p>siehe IncludeView, Inhalt wird erst bei Klick auf eine Schaltfläche geladen und angezeigt</p></li>
<li><p>der Parameter <code class="docutils literal notranslate"><span class="pre">text</span></code> bezieht sich auf die Beschriftung der Schaltfläche</p></li>
</ul>
</div></blockquote>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">DataLinqHelper.ResponsiveSwitcher()</span></code></p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p>Erzeugt eine Schaltfläche, die auf Klick alle HTML-Elemente mit der Klasse „responsive“ innerhalb der aktuellen Tabelle anzeigt bzw. wieder versteckt</p></li>
</ul>
</div></blockquote>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">DataLinqHelper.IncludeCombo(id,</span> <span class="pre">url,</span> <span class="pre">valueField,</span> <span class="pre">nameField)</span></code></p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p>Erzeugt eine Dropdown-Liste mit den Ergebnissen einer Abfrage</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">id</span></code> wird als HTML-Id-Attribut gesetzt</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">url</span></code> zeigt auf die Abfrage, deren Ergebnisse aufgelistet werden sollen</p>
<ul>
<li><p>Bspw. ein Abfrage mit GroupBy</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">valueField</span></code> befüllt den Options-Wert mit dem angegeben Feld aus den Ergebnissen</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nameField</span></code> befüllt den Options-Namen mit dem angegeben Feld aus den Ergebnissen</p></li>
</ul>
</div></blockquote>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">DLH.UrlEncode(text)</span></code></p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p>Kodiert den Text für die Verwendung in einer URL</p></li>
</ul>
</div></blockquote>
<p>Diese und weitere Hilfsfunktionen sind in der Hilfe zu DataLinqHelper mit Beispielen angeführt. Der Link zur Hilfe ist im Razor Markup Code Editor bei der Erstellung von Views rechts oben zu finden.</p>
<p>In den Views kann auch JavaScript in <code class="docutils literal notranslate"><span class="pre">&lt;script&gt;</span></code>-Tags definiert werden. jQuery ist bereits eingebunden.</p>
</div>
<div class="section" id="beschrankung-der-abfrageergebnisse-query">
<span id="anchor53"></span><h2><span class="sectnum">5.3</span> Beschränkung der Abfrageergebnisse - Query<a class="headerlink" href="#beschrankung-der-abfrageergebnisse-query" title="Link zu dieser Überschrift">¶</a></h2>
<p>Um die Serverlast und v.a. die Ladezeit beim Seitenaufbau am Client gering zu halten, ist es sinnvoll, die maximale Anzahl der Abfrageergebnisse und Felder zu beschränken:</p>
<ul>
<li><p>bei API-Endpoints auf die WebGIS-Api ist diese Anzahl mit 1000 Datensätzen festgelegt, hier werden alle Spalten zurückgegeben, die im CMS definiert sind.</p></li>
<li><p>DB-Abfragen können im SQL-Statement beschränkt werden, bspw.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 49%" />
<col style="width: 51%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>SELECT TOP 200       * …</p></td>
<td><p>bei MSSQL</p></td>
</tr>
<tr class="row-even"><td><p>SELECT * … LIMIT 200</p></td>
<td><p>bei MySQL, PostgreSQL</p></td>
</tr>
<tr class="row-odd"><td><p>SELECT * … WHERE ROWNUM &lt;= 200</p></td>
<td><p>bei Oracle</p></td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>Idealerweise sollten die Ergebnisse durch eine Filterung mit (optionalen) Parametern (siehe <a class="reference internal" href="parametrierung.html#anchor32"><span class="std std-ref">Kapitel 3.2</span></a>) soweit wie möglich eingeschränkt werden um den AnwenderInnen eine schnellere Auswahl zu ermöglichen und nicht hunderte Zeilen durchsuchen zu müssen.</p>
</div>
<div class="section" id="beschrankung-filtern-der-abfrageergebnisse">
<span id="anchor54"></span><h2><span class="sectnum">5.4</span> Beschränkung / Filtern der Abfrageergebnisse<a class="headerlink" href="#beschrankung-filtern-der-abfrageergebnisse" title="Link zu dieser Überschrift">¶</a></h2>
<p>Mithilfe von (optionalen) Parameter in den Queries lassen sich Abfrageergebnisse einschränken. In Views kann mit dem <code class="docutils literal notranslate"><span class="pre">DataLinqHelper.FilterView</span></code> ein Filter eingebaut werden, der eine einfache und übersichtliche Eingabe / Auswahl dieser Filterparameter ermöglicht. Im Hintergrund werden die Übergabeparameter einfach an die Aufruf-URL (siehe <a class="reference internal" href="aufrufundbeispiele.html#anchor4"><span class="std std-ref">Kapitel 4</span></a>) angehängt. Werden bereits beim Aufruf der View über die URL Filter- bzw. Sortierungsparameter definiert, so sind diese in der GUI bereits ausgefüllt bzw. gesetzt.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@DLH</span><span class="o">.</span><span class="n">FilterView</span><span class="p">(</span>
    <span class="s2">&quot;Filter&quot;</span><span class="p">,</span>
    <span class="n">new</span> <span class="n">Dictionary</span><span class="o">&lt;</span><span class="n">string</span><span class="p">,</span> <span class="nb">object</span><span class="o">&gt;</span><span class="p">(){</span>
        <span class="p">{</span><span class="s2">&quot;STATUS&quot;</span><span class="p">,</span> <span class="n">new</span> <span class="p">{</span> <span class="n">displayname</span><span class="o">=</span><span class="s2">&quot;Status&quot;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="s2">&quot;endpoint@lov-status&quot;</span><span class="p">,</span> <span class="n">valueField</span><span class="o">=</span><span class="s2">&quot;VALUE&quot;</span><span class="p">,</span> <span class="n">nameField</span><span class="o">=</span><span class="s2">&quot;NAME&quot;</span><span class="p">,</span> <span class="n">prependEmpty</span><span class="o">=</span><span class="n">true</span><span class="p">,</span> <span class="n">multiple</span><span class="o">=</span><span class="s2">&quot;multiple&quot;</span><span class="p">}</span> <span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;NACHNAME&quot;</span><span class="p">,</span> <span class="n">new</span> <span class="p">{</span> <span class="n">displayname</span><span class="o">=</span><span class="s2">&quot;Nachname&quot;</span> <span class="p">}</span> <span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;GAS&quot;</span><span class="p">,</span> <span class="n">new</span> <span class="p">{</span> <span class="n">displayname</span><span class="o">=</span><span class="s2">&quot;Nur Gas betroffen&quot;</span><span class="p">,</span> <span class="n">dataType</span><span class="o">=</span><span class="n">DataType</span><span class="o">.</span><span class="n">Checkbox</span> <span class="p">}</span> <span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;ERSTELLD_FROM&quot;</span><span class="p">,</span> <span class="n">new</span> <span class="p">{</span> <span class="n">displayname</span><span class="o">=</span><span class="s2">&quot;Datum von&quot;</span><span class="p">,</span> <span class="n">dataType</span><span class="o">=</span><span class="n">DataType</span><span class="o">.</span><span class="n">Date</span> <span class="p">}</span> <span class="p">},</span>
    <span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Ein Filterfeld kann als Auswahlliste definiert werden, dessen Werte aus einer anderen DataLinq-Query kommen, siehe Feld <code class="docutils literal notranslate"><span class="pre">STATUS</span></code>. Bei Bedarf können auch mehrere Listenwerte mit <code class="docutils literal notranslate"><span class="pre">;</span></code> getrennt übergeben werden (<code class="docutils literal notranslate"><span class="pre">multiple=“multiple“</span></code>). Im SQL-Statement muss diese Aneinanderreihung wieder aufgesplittet werden. Bei einer REST-API Abfrage muss im CMS die Abfrage-Methode des Suchfeldes als „In“ definiert werden.</p>
<p>Falls alle Filterfelder optional sind (also auch ohne eine einzige Einschränkung gesucht werden kann), kann man bei SQL-Statements eine allgemein gültige WHERE-Bedingung definieren und alle anderen optionalen Bedingungen mit „AND …“ anhängen.</p>
<p><strong>REST-API</strong></p>
<div class="highlight-REST notranslate"><div class="highlight"><pre><span></span>dienst@cms/queries/abfrage?

#if STATUS
    &amp;status_in={{STATUS}}
#endif
#if NACHNAME
    &amp;nachname={{NACHNAME}}
#endif
#if ERSTELLD_FROM
    &amp;date_from={{ERSTELLD_FROM}}
#endif
#if GAS
    &amp;gas_betroffen=Ja*
#endif
#if _orderby
    &amp;_orderby={{_orderby}}
#endif
</pre></div>
</div>
<p><strong>SQL</strong></p>
<div class="highlight-SQL notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="n">TOP</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">status</span><span class="p">,</span>
    <span class="n">erstellt</span><span class="p">,</span>
    <span class="p">...</span>
<span class="k">FROM</span> <span class="n">tabelle</span>
<span class="k">WHERE</span> <span class="mi">0</span> <span class="o">=</span> <span class="mi">0</span>

<span class="o">#</span><span class="k">if</span> <span class="n">STATUS</span>
    <span class="k">and</span> <span class="n">status</span> <span class="k">IN</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">value</span> <span class="k">FROM</span> <span class="n">STRING_SPLIT</span><span class="p">(</span><span class="o">@</span><span class="n">STATUS</span><span class="p">,</span> <span class="s1">&#39;;&#39;</span><span class="p">))</span>
<span class="o">#</span><span class="n">endif</span>

<span class="o">#</span><span class="k">if</span> <span class="n">NACHNAME</span>
    <span class="k">and</span> <span class="n">nachname</span> <span class="o">=</span> <span class="o">@</span><span class="n">NACHNAME</span>
<span class="o">#</span><span class="n">endif</span>

<span class="o">#</span><span class="k">if</span> <span class="n">GAS</span>
    <span class="k">and</span> <span class="n">gasanschluss</span> <span class="o">=</span> <span class="k">true</span>
<span class="o">#</span><span class="n">endif</span>
<span class="o">#</span><span class="k">if</span> <span class="n">ERSTELLD_FROM</span>
    <span class="k">and</span> <span class="n">erstellt</span> <span class="o">&gt;=</span> <span class="k">CONVERT</span> <span class="p">(</span><span class="nb">date</span><span class="p">,</span> <span class="o">@</span><span class="n">ERSTELLD_FROM</span><span class="p">,</span> <span class="mi">104</span><span class="p">)</span>
<span class="o">#</span><span class="n">endif</span>
<span class="o">#</span><span class="k">if</span> <span class="n">_orderby</span>
    <span class="k">ORDER</span> <span class="k">BY</span> <span class="o">@</span><span class="n">_orderby</span>
<span class="o">#</span><span class="n">endif</span>
</pre></div>
</div>
<p>In der View wird der Filter gerendert:</p>
<img alt="../_images/ad5_4.png" src="../_images/ad5_4.png" />
</div>
<div class="section" id="sortieren-der-abfrageergebnisse">
<span id="anchor55"></span><h2><span class="sectnum">5.5</span> Sortieren der Abfrageergebnisse<a class="headerlink" href="#sortieren-der-abfrageergebnisse" title="Link zu dieser Überschrift">¶</a></h2>
<p>Neben der Filterung steht mit DataLinqHelper.SortView ein weiterer Baustein zur Verfügung, mit dem die Datensätze im View per GUI sortiert werden können. Die Sortier-Felder werden wie die Filterparameter im Hintergrund an der Aufruf-URL mit <code class="docutils literal notranslate"><span class="pre">_orderby=…</span></code> angehängt. Absteigende Sortierungen werden mit einem Minus („-“) vor dem Spaltennamen übergeben.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@DLH</span><span class="o">.</span><span class="n">SortView</span><span class="p">(</span>
    <span class="s2">&quot;Sortierung&quot;</span><span class="p">,</span>
    <span class="n">new</span> <span class="n">Dictionary</span><span class="o">&lt;</span><span class="n">string</span><span class="p">,</span> <span class="nb">object</span><span class="o">&gt;</span><span class="p">(){</span>
        <span class="p">{</span><span class="s2">&quot;ERSTELLD&quot;</span><span class="p">,</span> <span class="n">new</span> <span class="p">{</span> <span class="n">displayname</span><span class="o">=</span><span class="s2">&quot;Zeitpunkt Erstellung&quot;</span> <span class="p">}},</span>
        <span class="p">{</span><span class="s2">&quot;STATUS&quot;</span><span class="p">,</span> <span class="n">new</span> <span class="p">{</span> <span class="n">displayname</span><span class="o">=</span><span class="s2">&quot;Status&quot;</span> <span class="p">}},</span>
    <span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
<p>In der Query müssen diese Felder entgegengenommen werden, siehe Statements in <a class="reference internal" href="#anchor54"><span class="std std-ref">Kapitel 5.4</span></a> In der View wird das Sortierwerkzeug gerendert:</p>
<img alt="../_images/ad5_6.png" src="../_images/ad5_6.png" />
</div>
<div class="section" id="aktualisierung-aufteilen-von-statischen-und-dynamischen-inhalten">
<span id="anchor56"></span><h2><span class="sectnum">5.6</span> Aktualisierung - Aufteilen von statischen und dynamischen Inhalten<a class="headerlink" href="#aktualisierung-aufteilen-von-statischen-und-dynamischen-inhalten" title="Link zu dieser Überschrift">¶</a></h2>
<p>Bei der (periodischen) Aktualisierung von Views werden alle Inhalte neu geladen. Falls in den Views CSS-Styles oder JavaScript vorkommt, wird dieses ebenfalls wieder dazu geladen und kann (v.a. bei JavaScript-Triggern) die Seite auf Dauer langsam machen (bis wieder eine „harte“ Aktualisierung mit F5, oder ein neuer Aufruf über die URL erfolgt).</p>
<p>Ein Beispiel für View-Inhalte die häufig am selben Client aktualisiert werden könnten Hydrographie-Daten – als eine Art Dashboard, das je Minute aktualisiert wird – sein. In der „einfachen“ Form besteht diese Seite aus den tabellarischen Daten (HTML), Karte (JavaScript), CSS-Styles und JavaScript zum Anzeige der Diagramme – alles in einer einzigen View. Wenn dieser View über den <code class="docutils literal notranslate"><span class="pre">DLH.RefreshViewTicker</span></code> alle 60 Sekunden neu geladen wird, kommt jedes Mal JavaScript und CSS dazu – obwohl sich nur die tabellarischen Daten (HTML) ändern.</p>
<p>Hier macht es Sinn, den statischen, immer gleich bleibenden Code (JavaScript, CSS) vom dynamischen Teil (HTML) zu trennen und nur diesen neu zu laden. Immer wenn ein View neu geladen wurde, wird das Event „onpageloaded“ gefeuert. Auf dieses Ereignis kann im statischen Teil wird reagiert und bspw. Klick-Listener gesetzt werden:</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
    webgis_datalinq.events.on(&#39;onpageloaded, function(channel, sender, args){
        $(&quot;.TABDET.clickable tbody tr.extended-click&quot;).on(&quot;click&quot;, function() {
            var id = $(this).attr(&quot;stoer_id&quot;);
            ...
</pre></div>
</div>
</div>
<div class="section" id="queries-mit-domain-ubersetzung">
<span id="anchor57"></span><h2><span class="sectnum">5.7</span> Queries mit Domain-Übersetzung<a class="headerlink" href="#queries-mit-domain-ubersetzung" title="Link zu dieser Überschrift">¶</a></h2>
<p>Wer kennt es nicht: In einer Tabelle wird ein Attribut eines Objektes mit einem Wert kodiert, bspw. 0 für 0 „Wald“, 1 für „Wiese“ und 2 für „verbautes Gebiet“. In einer Tabellenansicht möchte man diese Werte nun mit den richtigen Namen übersetzen um es den NutzerInnen verständlicher zu machen. Natürlich könnte man im Code des Views eine Unterscheidung bauen. Kling kompliziert? Ist es ja auch! Wir haben eine viel einfachere Lösung für Sie: Query-Domains!</p>
<img alt="../_images/ad5_8.png" src="../_images/ad5_8.png" />
<p>Im „Destination Field“ wird die Spaltenbezeichnung (kann auch ein Alias sein) jenes Feldes angegeben, das die kodierten Werte enthält. Unter „Query Id“ wird eine Lookup-Tabelle angegeben, die einerseits die kodierten Werte enthält und andererseits die Übersetzung. „Value-“ bzw. „Name Field“ geben die Spaltennamen dieser Lookup-Tabelle an. Wird im View des ursprünglichen Query auf das Feld (in der Grafik „STATUS_NAME“) zugegriffen, so wird nicht der kodierte Werte (bspw. 1) sondern die Übersetzung („Wiese“) ausgegeben. Tja, mit Query-Domains kann das Leben so einfach sein! Starten Sie jetzt.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="examples.html" class="btn btn-neutral float-right" title="6 Weitere Beispiele" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="aufrufundbeispiele.html" class="btn btn-neutral float-left" title="4 Aufruf und Beispiele" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, ENI

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>